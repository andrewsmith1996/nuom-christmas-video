<html>
  <head>
    <style>
      body {
        padding: 0;
        margin:0;
      }

      #frame {
        width:100%;
        height:100%;
        position: relative;
        overflow: hidden;
      }

      video {
        position: absolute;
        transform-origin: top left;
        transform:scale(2);
        -webkit-transform-origin: top left;
        -webkit-transform:scale(2);
      }
    </style>

    <script>
      var host = location.origin.replace(/^http/, 'ws');
      var ws = new WebSocket(host);
      var state = {
        id:null,
        top:0,
        left:0,
        rotation:'0rad',
        scale:2,
        width: window.innerWidth,
        height: window.innerHeight
      };
      ws.onmessage = function (event) {
        var data = JSON.parse(event.data);
        if (data.newId) {
          state.id = data.newId;
        } else if ((data.deviceId == state.id || data.deviceId =='all') && data.changes) {
          var element = document.querySelector('video');
          if (data.changes.position) {
            state.top = element.style.top = (data.changes.position.top * state.scale);
            state.left = element.style.left = (data.changes.position.left * state.scale);
          }
          if (data.changes.rotation) {
            var rotation = state.rotation = data.changes.rotation;
            var parent = document.getElementById('video-container');
            var originY = ( state.top + (state.height / 2)  * state.scale) + 'px';
            var originX = ( state.left + (state.width / 2) * state.scale) + 'px';
            parent.style.transformOrigin = [originX, originY, 0].join(' ');
            parent.style.transform = 'rotate(' + rotation + ')';
          }
          if (data.changes.scale) {
            var scale = data.changes.scale;
            element.style.transform = 'scale(' + scale + ')';
          }
        } else if (data == 'reset') {
          document.querySelector('video').currentTime = 0;
        } else if (data == 'pause') {
          document.querySelector('video').pause();
        } else if (data == 'resume') {
          document.querySelector('video').play();
        }
      };
      ws.onopen = function(event) {
        send({initialValues:{height: state.height, width: state.width}});
      };

      function send(data) {
        ws.send(JSON.stringify(data))
      }
    </script>
  </head>
  <body>
    <div id="frame">
      <div id="video-container">
        <video src="SampleVideo.mp4" muted autoplay loop></video>
      </div>
    </div>
  </body>
</html>
